@{
    ViewData["Title"] = "لوحة التحكم";
}

<section class="container py-5">
    <div class="text-center mb-5">
        <h1 class="text-gold fw-bold">لوحة التحكم</h1>
        <p class="text-white">نظرة عامة على أداء العمال والفئات</p>
    </div>

    <div class="row g-4">
        <div class="col-lg-6">
            <div class="card bg-dark border-gold shadow-lg h-100">
                <div class="card-body">
                    <h5 class="text-gold mb-3">إجمالي الرواتب حسب الفئة</h5>
                    <canvas id="payrollChart"></canvas>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="card bg-dark border-gold shadow-lg h-100">
                <div class="card-body">
                    <h5 class="text-gold mb-3">توزيع العمال حسب الفئة</h5>
                    <canvas id="workerDistChart"></canvas>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="card bg-dark border-gold shadow-lg h-100">
                <div class="card-body">
                    <h5 class="text-gold mb-3">إجمالي الرواتب الأسبوعية</h5>
                    <canvas id="weeklyPayrollChart"></canvas>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="card bg-dark border-gold shadow-lg h-100">
                <div class="card-body">
                    <h5 class="text-gold mb-3">أيام الحضور حسب الفئة</h5>
                    <canvas id="attendanceChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Chart 1: Payroll by Category
            var payrollLabels = @Html.Raw(Json.Serialize(ViewBag.ChartLabels));
            var payrollData = @Html.Raw(Json.Serialize(ViewBag.ChartData));
            if (payrollLabels && payrollData) {
                new Chart(document.getElementById('payrollChart'), {
                    type: 'bar',
                    data: {
                        labels: payrollLabels,
                        datasets: [{
                            label: 'إجمالي الراتب',
                            data: payrollData,
                            backgroundColor: 'rgba(212, 175, 55, 0.7)',
                        }]
                    }
                });
            }

            // Chart 2: Worker Distribution
            var workerDistLabels = @Html.Raw(Json.Serialize(ViewBag.WorkerDistLabels));
            var workerDistData = @Html.Raw(Json.Serialize(ViewBag.WorkerDistData));
            if (workerDistLabels && workerDistData) {
                new Chart(document.getElementById('workerDistChart'), {
                    type: 'pie',
                    data: {
                        labels: workerDistLabels,
                        datasets: [{
                            data: workerDistData,
                            backgroundColor: ['#d4af37', '#b8922e', '#9b7723', '#7d5d18', '#5e430d'],
                        }]
                    }
                });
            }

            // Chart 3: Weekly Payroll
            var weeklyPayrollLabels = @Html.Raw(Json.Serialize(ViewBag.WeeklyPayrollLabels));
            var weeklyPayrollData = @Html.Raw(Json.Serialize(ViewBag.WeeklyPayrollData));
            if (weeklyPayrollLabels && weeklyPayrollData) {
                new Chart(document.getElementById('weeklyPayrollChart'), {
                    type: 'line',
                    data: {
                        labels: weeklyPayrollLabels,
                        datasets: [{
                            label: 'إجمالي الراتب الأسبوعي',
                            data: weeklyPayrollData,
                            borderColor: '#d4af37',
                            tension: 0.2
                        }]
                    }
                });
            }

            // Chart 4: Attendance by Category
            var attendanceLabels = @Html.Raw(Json.Serialize(ViewBag.AttendanceLabels));
            var attendanceData = @Html.Raw(Json.Serialize(ViewBag.AttendanceData));
            if (attendanceLabels && attendanceData) {
                new Chart(document.getElementById('attendanceChart'), {
                    type: 'bar',
                    data: {
                        labels: attendanceLabels,
                        datasets: [{
                            label: 'إجمالي أيام الحضور',
                            data: attendanceData,
                            backgroundColor: 'rgba(212, 175, 55, 0.8)',
                        }]
                    }
                });
            }
        });
    </script>
}
